{"ast":null,"code":"import _slicedToArray from\"/Users/dotu/repo/interface/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Trans}from\"@lingui/react\";import{Box}from'nft/components/Box';import{Column,Row}from'nft/components/Flex';import{AttachPriceIcon,EditPriceIcon}from'nft/components/icons';import{NumericInput}from'nft/components/layout/Input';import{badge,body}from'nft/css/common.css';import{useSellAsset}from'nft/hooks';import{formatEth}from'nft/utils/currency';import{useEffect,useRef,useState}from'react';import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var WarningType;(function(WarningType){WarningType[WarningType[\"BELOW_FLOOR\"]=0]=\"BELOW_FLOOR\";WarningType[WarningType[\"ALREADY_LISTED\"]=1]=\"ALREADY_LISTED\";WarningType[WarningType[\"NONE\"]=2]=\"NONE\";})(WarningType||(WarningType={}));var getWarningMessage=function getWarningMessage(warning){var message=/*#__PURE__*/_jsx(_Fragment,{});switch(warning){case WarningType.BELOW_FLOOR:message=/*#__PURE__*/_jsx(Trans,{id:\"LISTING BELOW FLOOR\"});break;case WarningType.ALREADY_LISTED:message=/*#__PURE__*/_jsx(Trans,{id:\"ALREADY LISTED FOR\"});break;}return message;};export var PriceTextInput=function PriceTextInput(_ref){var _asset$floorPrice2,_asset$floor_sell_ord;var listPrice=_ref.listPrice,setListPrice=_ref.setListPrice,isGlobalPrice=_ref.isGlobalPrice,setGlobalOverride=_ref.setGlobalOverride,globalOverride=_ref.globalOverride,warning=_ref.warning,asset=_ref.asset,shrink=_ref.shrink;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),focused=_useState2[0],setFocused=_useState2[1];var _useState3=useState(WarningType.NONE),_useState4=_slicedToArray(_useState3,2),warningType=_useState4[0],setWarningType=_useState4[1];var removeMarketplaceWarning=useSellAsset(function(state){return state.removeMarketplaceWarning;});var removeSellAsset=useSellAsset(function(state){return state.removeSellAsset;});var inputRef=useRef();useEffect(function(){inputRef.current.value=listPrice!==undefined?\"\".concat(listPrice):'';setWarningType(WarningType.NONE);if(!warning&&listPrice){var _asset$floorPrice;if(listPrice<((_asset$floorPrice=asset===null||asset===void 0?void 0:asset.floorPrice)!==null&&_asset$floorPrice!==void 0?_asset$floorPrice:0))setWarningType(WarningType.BELOW_FLOOR);else if(asset.floor_sell_order_price&&listPrice>=asset.floor_sell_order_price)setWarningType(WarningType.ALREADY_LISTED);}else if(warning&&listPrice&&listPrice>=0)removeMarketplaceWarning(asset,warning);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[listPrice]);return/*#__PURE__*/_jsxs(Column,{gap:\"12\",position:\"relative\",children:[/*#__PURE__*/_jsxs(Row,{color:\"textTertiary\",height:\"44\",width:\"min\",padding:\"4\",borderRadius:\"8\",borderWidth:\"2px\",borderStyle:\"solid\",marginRight:\"auto\",borderColor:warningType!==WarningType.NONE&&!focused?'orange':isGlobalPrice?'accentAction':listPrice!=null?'textSecondary':'blue400',children:[/*#__PURE__*/_jsx(NumericInput,{as:\"input\",pattern:\"[0-9]\",borderStyle:\"none\",className:body,color:{placeholder:'textSecondary',default:'textPrimary'},placeholder:\"0\",marginRight:\"0\",marginLeft:\"14\",backgroundColor:\"none\",style:{width:shrink?'54px':'68px'},onFocus:function onFocus(){return setFocused(true);},onBlur:function onBlur(){setFocused(false);},ref:inputRef,onChange:function onChange(v){if(!listPrice&&v.currentTarget.value.includes('.')&&parseFloat(v.currentTarget.value)===0){return;}var val=parseFloat(v.currentTarget.value);setListPrice(isNaN(val)?undefined:val);}}),/*#__PURE__*/_jsx(Box,{color:listPrice&&listPrice>=0?'textPrimary':'textSecondary',marginRight:\"16\",children:\"\\xA0ETH\"}),/*#__PURE__*/_jsx(Box,{cursor:\"pointer\",display:isGlobalPrice||globalOverride?'block':'none',position:\"absolute\",style:{marginTop:'-36px',marginLeft:'124px'},backgroundColor:\"backgroundSurface\",onClick:function onClick(){return setGlobalOverride(!globalOverride);},children:globalOverride?/*#__PURE__*/_jsx(AttachPriceIcon,{}):/*#__PURE__*/_jsx(EditPriceIcon,{})})]}),/*#__PURE__*/_jsx(Row,{top:\"52\",width:\"max\",className:badge,color:warningType===WarningType.BELOW_FLOOR&&!focused?'orange':'textSecondary',position:\"absolute\",right:{sm:'0',md:'unset'},children:warning?warning.message:warningType!==WarningType.NONE&&/*#__PURE__*/_jsxs(_Fragment,{children:[getWarningMessage(warningType),\"\\xA0\",warningType===WarningType.BELOW_FLOOR?formatEth((_asset$floorPrice2=asset===null||asset===void 0?void 0:asset.floorPrice)!==null&&_asset$floorPrice2!==void 0?_asset$floorPrice2:0):formatEth((_asset$floor_sell_ord=asset===null||asset===void 0?void 0:asset.floor_sell_order_price)!==null&&_asset$floor_sell_ord!==void 0?_asset$floor_sell_ord:0),\"ETH\",/*#__PURE__*/_jsx(Box,{color:warningType===WarningType.BELOW_FLOOR?'accentAction':'orange',marginLeft:\"8\",cursor:\"pointer\",onClick:function onClick(){warningType===WarningType.ALREADY_LISTED&&removeSellAsset(asset);setWarningType(WarningType.NONE);},children:warningType===WarningType.BELOW_FLOOR?/*#__PURE__*/_jsx(Trans,{id:\"DISMISS\"}):/*#__PURE__*/_jsx(Trans,{id:\"REMOVE ITEM\"})})]})})]});};","map":{"version":3,"names":["Box","Column","Row","AttachPriceIcon","EditPriceIcon","NumericInput","badge","body","useSellAsset","formatEth","useEffect","useRef","useState","WarningType","getWarningMessage","warning","message","BELOW_FLOOR","ALREADY_LISTED","PriceTextInput","listPrice","setListPrice","isGlobalPrice","setGlobalOverride","globalOverride","asset","shrink","focused","setFocused","NONE","warningType","setWarningType","removeMarketplaceWarning","state","removeSellAsset","inputRef","current","value","undefined","floorPrice","floor_sell_order_price","placeholder","default","width","v","currentTarget","includes","parseFloat","val","isNaN","marginTop","marginLeft","sm","md"],"sources":["/Users/dotu/repo/interface/src/nft/components/profile/list/PriceTextInput.tsx"],"sourcesContent":["import { Trans } from '@lingui/macro'\nimport { Box } from 'nft/components/Box'\nimport { Column, Row } from 'nft/components/Flex'\nimport { AttachPriceIcon, EditPriceIcon } from 'nft/components/icons'\nimport { NumericInput } from 'nft/components/layout/Input'\nimport { badge, body } from 'nft/css/common.css'\nimport { useSellAsset } from 'nft/hooks'\nimport { ListingWarning, WalletAsset } from 'nft/types'\nimport { formatEth } from 'nft/utils/currency'\nimport { Dispatch, FormEvent, useEffect, useRef, useState } from 'react'\n\nenum WarningType {\n  BELOW_FLOOR,\n  ALREADY_LISTED,\n  NONE,\n}\n\nconst getWarningMessage = (warning: WarningType) => {\n  let message = <></>\n  switch (warning) {\n    case WarningType.BELOW_FLOOR:\n      message = <Trans>LISTING BELOW FLOOR </Trans>\n      break\n    case WarningType.ALREADY_LISTED:\n      message = <Trans>ALREADY LISTED FOR </Trans>\n      break\n  }\n  return message\n}\n\ninterface PriceTextInputProps {\n  listPrice?: number\n  setListPrice: Dispatch<number | undefined>\n  isGlobalPrice: boolean\n  setGlobalOverride: Dispatch<boolean>\n  globalOverride: boolean\n  warning?: ListingWarning\n  asset: WalletAsset\n  shrink?: boolean\n}\n\nexport const PriceTextInput = ({\n  listPrice,\n  setListPrice,\n  isGlobalPrice,\n  setGlobalOverride,\n  globalOverride,\n  warning,\n  asset,\n  shrink,\n}: PriceTextInputProps) => {\n  const [focused, setFocused] = useState(false)\n  const [warningType, setWarningType] = useState(WarningType.NONE)\n  const removeMarketplaceWarning = useSellAsset((state) => state.removeMarketplaceWarning)\n  const removeSellAsset = useSellAsset((state) => state.removeSellAsset)\n  const inputRef = useRef() as React.MutableRefObject<HTMLInputElement>\n\n  useEffect(() => {\n    inputRef.current.value = listPrice !== undefined ? `${listPrice}` : ''\n    setWarningType(WarningType.NONE)\n    if (!warning && listPrice) {\n      if (listPrice < (asset?.floorPrice ?? 0)) setWarningType(WarningType.BELOW_FLOOR)\n      else if (asset.floor_sell_order_price && listPrice >= asset.floor_sell_order_price)\n        setWarningType(WarningType.ALREADY_LISTED)\n    } else if (warning && listPrice && listPrice >= 0) removeMarketplaceWarning(asset, warning)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [listPrice])\n\n  return (\n    <Column gap=\"12\" position=\"relative\">\n      <Row\n        color=\"textTertiary\"\n        height=\"44\"\n        width=\"min\"\n        padding=\"4\"\n        borderRadius=\"8\"\n        borderWidth=\"2px\"\n        borderStyle=\"solid\"\n        marginRight=\"auto\"\n        borderColor={\n          warningType !== WarningType.NONE && !focused\n            ? 'orange'\n            : isGlobalPrice\n            ? 'accentAction'\n            : listPrice != null\n            ? 'textSecondary'\n            : 'blue400'\n        }\n      >\n        <NumericInput\n          as=\"input\"\n          pattern=\"[0-9]\"\n          borderStyle=\"none\"\n          className={body}\n          color={{ placeholder: 'textSecondary', default: 'textPrimary' }}\n          placeholder=\"0\"\n          marginRight=\"0\"\n          marginLeft=\"14\"\n          backgroundColor=\"none\"\n          style={{ width: shrink ? '54px' : '68px' }}\n          onFocus={() => setFocused(true)}\n          onBlur={() => {\n            setFocused(false)\n          }}\n          ref={inputRef}\n          onChange={(v: FormEvent<HTMLInputElement>) => {\n            if (!listPrice && v.currentTarget.value.includes('.') && parseFloat(v.currentTarget.value) === 0) {\n              return\n            }\n            const val = parseFloat(v.currentTarget.value)\n            setListPrice(isNaN(val) ? undefined : val)\n          }}\n        />\n        <Box color={listPrice && listPrice >= 0 ? 'textPrimary' : 'textSecondary'} marginRight=\"16\">\n          &nbsp;ETH\n        </Box>\n        <Box\n          cursor=\"pointer\"\n          display={isGlobalPrice || globalOverride ? 'block' : 'none'}\n          position=\"absolute\"\n          style={{ marginTop: '-36px', marginLeft: '124px' }}\n          backgroundColor=\"backgroundSurface\"\n          onClick={() => setGlobalOverride(!globalOverride)}\n        >\n          {globalOverride ? <AttachPriceIcon /> : <EditPriceIcon />}\n        </Box>\n      </Row>\n      <Row\n        top=\"52\"\n        width=\"max\"\n        className={badge}\n        color={warningType === WarningType.BELOW_FLOOR && !focused ? 'orange' : 'textSecondary'}\n        position=\"absolute\"\n        right={{ sm: '0', md: 'unset' }}\n      >\n        {warning\n          ? warning.message\n          : warningType !== WarningType.NONE && (\n              <>\n                {getWarningMessage(warningType)}\n                &nbsp;\n                {warningType === WarningType.BELOW_FLOOR\n                  ? formatEth(asset?.floorPrice ?? 0)\n                  : formatEth(asset?.floor_sell_order_price ?? 0)}\n                ETH\n                <Box\n                  color={warningType === WarningType.BELOW_FLOOR ? 'accentAction' : 'orange'}\n                  marginLeft=\"8\"\n                  cursor=\"pointer\"\n                  onClick={() => {\n                    warningType === WarningType.ALREADY_LISTED && removeSellAsset(asset)\n                    setWarningType(WarningType.NONE)\n                  }}\n                >\n                  {warningType === WarningType.BELOW_FLOOR ? <Trans>DISMISS</Trans> : <Trans>REMOVE ITEM</Trans>}\n                </Box>\n              </>\n            )}\n      </Row>\n    </Column>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}